\documentclass{ximera}

\input{../preamble.tex}

\outcome{Describe the relationship between the product rule and integration by parts.}
\outcome{Identify the functions required to transform the integral via integration by parts.}
\outcome{Evaluate integrals using integration by parts, including multiple iterations.}
\outcome{Use integration by parts to derive reduction formulas.}

\title[Dig-In:]{Integration by parts}

\begin{document}
\begin{abstract}
  We learn a new technique, called integration by parts, to help find antiderivatives
\end{abstract}
\maketitle

We have seen applications of integration such as finding areas between curves, calculating volumes of certain solids, and some physical applications. In order to compute these definite integrals we have relied on the Fundamental Theorem of Calculus, which allows us to easily compute the definite integral if we can find the antideritive of the integrand. 

Consider the following example. 
\begin{example}
Let $R$ be the region between $\sin(8x)$ and the $x$-axis on the interval $\left[0, \frac{\pi}{8} \right]$. Let $S$ be the solid obtained by revolving $R$ around the $y$-axis. If we use the shell method to setup an integral that gives the volume of $S$, we obtain:
\[
\int_{0}^{\frac{\pi}{8}} 2 \pi x\sin(8x) \d x
\]
To determine the volume of $S$ we need to find an antiderivative of $x\sin(8x)$. However, none of our previous methods allow us to do this.
\end{example}

Since antidifferentiation is simply "undoing" the derivative, we will look at the differentiation rules and see if we can come up with useful antiderivative rules by working backwards. The substitution method came about by reversing the chain rule for derivatives. Another useful antiderivative technique, called \textit{integration by parts}, can be developed by looking at the product rule and working backwards. 

\begin{theorem}[Integration by Parts Formula] 
Suppose $f(x)$ and $g(x)$ are both differentiable on the interval $[a,b]$. Then 
\[
\int_a^b f(x) g'(x) \d x =\eval{f(x)g(x)}_a^b - \int_a^b f'(x) g(x) \d x.
\]
\begin{explanation} First note that by the product rule we have
\[
\ddx f(x)g(x) = f(x)g'(x) + f'(x) g(x).
\]
Now integrate both sides of the equation above
\[
\int_a^b \ddx f(x) g(x) \d x = \int_a^b \left(f(x)g'(x) + f'(x) g(x)\right) \d x.
\]
By the Fundamental Theorem of Calculus, the left-hand side of the equation is:
\[
\eval{f(x)g(x)}_a^b
\]
However, by the linearity of integrals the right-hand side is equal to 
\[
\int_a^b f(x)g'(x)\d x + \int_a^b f'(x) g(x) \d x.
\]
Hence
\[
\eval{f(x)g(x)}_a^b = \int_a^b f(x)g'(x)\d x + \int_a^b f'(x) g(x) \d x.
\]
and so 
\[
 \int_a^b f(x)g'(x)\d x = \eval{f(x)g(x)}_a^b -  \int_a^b f'(x) g(x) \d x.
\]
\end{explanation}
\end{theorem}


Integration by parts is often written in a more compact form
\[
\int u\d v = uv-\int v\d u,
\]
where $u=f(x)$, $v=g(x)$, $\d u=f'(x)\d x$ and $\d v=g'(x)\d x$.  \\

To use integration by parts we need to identify likely candidates for $u=f(x)$ and
$\d v=g'(x)\d x$.  There is no algorithm that always tells us what to choose for $u$ and $dv$. We want to choose $u$ and $\d v$ so that $\int v \d u$ is easier to integrate than the original integral $\int u \d v$/.  The best choice will depend on the particular problem at hand. Later we will give some advice for choosing $u$ and $\d v$. 

\begin{question}
  Which of the following are always true? (Assuming $f(x)g(x)$ is
  differentiable on a relevant interval.)
  \begin{selectAll}
    \choice{$\int f(x) \cdot g(x) \d x = \left(\int f(x) \d x\right) \cdot \left(\int g(x) \d x\right)$}
    \choice{$\int f(x) \cdot 4 \d x = \left(\int f(x) \d x\right) \cdot \left(\int 4 \d x\right)$}
    \choice[correct]{$\int f(x) \cdot 4 \d x = 4\int f(x) \d x$}
    \choice[correct]{$\int f(x) \cdot g'(x) \d x = f(x) g(x) - \int f'(x)\cdot g(x) \d x$}
    \choice{$\int_a^b f(x) \cdot g'(x) \d x = f(x) g(x) - \int_a^b f'(x)\cdot g(x) \d x$}
    \choice[correct]{$\int_a^b f(x) \cdot g'(x) \d x = \eval{f(x) g(x)}_a^b + \int_b^a f(x)'\cdot g(x) \d x$}
  \end{selectAll}
\end{question}

\begin{example}
Now let us return to our example that opened the section:
\[
\int_{0}^{\frac{\pi}{8}} 2 \pi x\sin(8x) \d x
\]

\begin{explanation}
We first need to find the antiderivative $\int x\sin(8x) \d x$.  Since $x\sin(8x)$ is a product and none of our previous techniques work, we can try integration by parts.  Note that $x$ gets simpler when we differentiate it, and $\sin(8x)$ does not get that much more complex when it is integrated, so let's try $u=x$ and $\ dv=\sin(8x) \d x$.  
We must determine $\d u$ and  $v$. We get
\[ \d u=\d x \text{ and } v=\frac{-\cos(8x)}{8} \]

The integration by parts formula gives us:

\[ 
\int x\sin(8x) \d x= -x\frac{\cos(8x)}{8} -\int \frac{-\cos(8x)}{8} \d x 
\]

We have now reduced this problem to an integral we know how to solve.  

The volume of $S$ is :

\[ 
\int_{0}^{\frac{\pi}{8}} 2 \pi x\sin(8x) \d x= 2 \pi \int_{0}^{\frac{\pi}{8}} x\sin(8x) \d x= 2 \pi \left( \eval{\frac{-x\cos(8x)}{8}}_0^\frac{\pi}{8}- \int_{0}^{\frac{\pi}{8}} \frac{-\cos(8x)}{8} \d x \right)=\frac{\pi^{2}}{32}
\]

\end{explanation}
\end{example}

\section{Basic examples}


We'll now work some standard examples.

%\begin{example}
%Compute:
%\[
%\int x\sin(x) \d x
%\]
%\begin{explanation} Let $u=x$ so $\d u=\d x$. Hence, $\d v=\answer[given]{\sin(x)}\d x$ so $v=\answer[given]{-\cos(x)}$ and
%\begin{align*}
%\int x\sin(x)\d x &=\answer[given]{-x\cos(x)}-\int -\cos(x)\d x\\
%&= \answer[given]{-x\cos(x)}+\int \cos(x)\d x\\
%&=\answer[given]{-x\cos(x)}+\answer[given]{\sin x}+C.
%\end{align*}
%Let us verify the solution by taking the derivative:
%\[
%\ddx \left(-x \cos(x) + \sin(x) + C \right)=-1 \cos(x)+x\sin(x) +\cos(x)=x \sin(x)
%\]
%\end{explanation}
%\end{example}

\begin{example}
Determine the integral:

\[
\int xe^{x} \d x
\]

\begin{explanation}
This is not a function who's antiderivative we already know.  There is no way to algebraically simplify this expression, and $u$-substitution won't workhere.  The integrand is a product so let's try integration by parts.  Note that $x$ gets simpler when we differentiate it, and $e^{x}$ does not get more complex when it is integrated, so let's choose $u=x$ and $\d v=e^{x} \d x$.
Then 
\[
\d u= \d x \text{ and }  v=e^{x}
\]

Then we have:
\[
\int xe^{x} \d x= xe^{x}-\int e^{x} \d x=xe^{x}-e^{x} + C
\]

\end{explanation}
\end{example}

\begin{example}
Compute:
\[
\int \ln(x)\d x
\]
\begin{explanation}
We don't immediately how to find an antiderivative of $ln(x)$, but we do know how to find it's derivative.  If we try using integration by parts on this problem with $u=\ln(x)$, we could take the derivative of $\ln(x)$.  But what should we use for $\d v$?  The only thing we have not used is the $\d x$, so we set $\d v = \d x$.  

$u=\ln(x)$ so $\d u=\answer[given]{1/x}\d x$. 

$\d v=1\d x$ so $v=\answer[given]{x}$
and so 
\begin{align*}
 \int \ln(x)\d x&=\answer[given]{x \ln(x)}-\int \frac{x}{x}\d x\\
&= x\ln (x)- \answer[given]{x}+C.\\
\end{align*}
\end{explanation}
\end{example}

\begin{example}
Determine the integral:
\[ 
\int \arctan(x) \d x
\]
\begin{explanation}
Let's try using the same arguement as the previous example.  Let $u=\answer[given]{\arctan (x)}$ so $\d u=\answer[given]{\frac{1}{1+x^{2}} } \d x$. Thus $\d v=\answer[given]{1} \d x$ and so $v=\answer[given]{x}$. 
This means that:

\[
\int \arctan(x) \d x= \answer[given]{x\arctan(x)}- \int \answer[given]{\frac{x}{1+x^{2}}} \d x
\]

We still need to determine $\int \frac{x}{1+x^{2}} \d x$. This is a product of functions, but we don't want to use integration by parts here.  We can use substitution to determine this antiderivative. 

Let $w=\answer[given]{1+x^{2}}$. Then $\d w=\answer[given]{2 x} \d x$. Hence, 
\[
\int \frac{x}{1+x^{2}} \d x= \int \answer[given]{\frac{1}{2 w}} \d w \\
 = \int \frac{1}{2} \ln(w) + C=\frac{1}{2} \ln(1+x^{2})+C \\
\]

Thus we have:
\[ 
\int \arctan(x) \d x = x \arctan(x) -\frac{1}{2} \ln(1+x^{2}) +C
\]
\end{explanation}
\end{example}






\section{Repeated integration by parts}

The  integration by parts formula
 \[
\int u \d v= uv - \int v \d u
\]
 is intended to replace the orginal integral with one that is easier to determine. However the integral $\int v \d u$ that results may also require integration by parts. This can lead to situations where we may need to apply integration by parts repeatedly until we obtain an integral which we know how to compute. 


%\begin{example}
%Determine the integral:
%\[\int x^{2} e^{x} \d x
%\]
%\begin{explanation}
%We choose $u=x^{2}$ and $\d v=e^{x}$. Then 
%\[ 
%\d u=\answer[given]{x}\d x \text{ and } v=\answer[given]{e^{x}}
%\]
%Using the integration by parts formula $\int u \d v = uv - \int v \d u$ gives :
%\[ 
%\int x^{2}e^{x} \d x= \answer[given]{ x^{2}e^{x}} - \int \answer[given]{e^{x}} x \d x
%\]
%
%We have reduced the computation of our original integral to computing the integral $\int xe^{x} \d x$, which was our first example in this section. Thus the original integral $\int x^{2}e^{x} \d x$ requires two applications of integration by parts. 
%\end{explanation}
%\end{example}

\begin{example}
Compute:
\[
\int x^2\sin(x)\d x
\] 
\begin{explanation}
Let $u=x^2$, $\d v=\sin(x)\d x$; then $\d u=\answer[given]{2x}\d x$ and $v=\answer[given]{-\cos(x)}$. 

Now 
\[
\int x^2\sin(x)\d x=\answer[given]{-x^2\cos(x)}+\int 2x\cos(x)\d x.
\] 
This is better than the original integral, but we need to do
integration by parts again on the rightmost integral. Let $u=2x$, $\d v=\cos(x)\d x$; then $\d u=\answer[given]{2}$
and $v=\answer[given]{\sin(x)}$, and
\begin{align*}
  \int x^2\sin(x)\d x &=\answer[given]{-x^2\cos(x)}+\int 2x\cos(x)\d x \\
  &=-x^2\cos(x)+ 2x\sin(x) - \int 2\sin(x)\d x \\
  &=-x^2\cos(x)+ 2x\sin(x) + 2\cos(x) + C. 
\end{align*}
\end{explanation}
\end{example}





Such repeated use of integration by parts is fairly common, but it can
be a bit tedious to accomplish, and it is easy to make
errors, especially sign errors involving the subtraction in the
formula. There is a nice tabular method to accomplish the calculation
that minimizes the chance for error and speeds up the whole
process. We illustrate with the previous example. Here is the
table:
\[
\begin{array}{|c|c|c|}\hline
\text{sign} & u & dv \\ \hline \hline
 & x^2 & \sin(x) \\ \hline
- & 2x & -\cos(x) \\ \hline
  & 2  & -\sin(x) \\ \hline
- & 0  & \cos(x) \\ \hline
\end{array}
\qquad\text{or}\qquad
\begin{array}{|c|c|}\hline
u & dv \\ \hline\hline
x^2 & \sin(x) \\ \hline 
-2x & -\cos(x) \\\hline
2 & -\sin(x)\\\hline
0 & \cos(x)\\\hline
\end{array}
\]

To form the first table, we start with $u$ at the top of the second
column and repeatedly compute the derivative; starting with $dv$ at
the top of the third column, we repeatedly compute the
antiderivative. In the first column, we place a ``$-$'' in every
second row. To form the second table we combine the first and second
columns by ignoring the boundary; if you do this by hand, you may
simply start with two columns and add a ``$-$'' to every second row.

To compute with this second table we begin at the top. Multiply the
first entry in column $u$ by the second entry in column $dv$ to get
$-x^2\cos(x)$, and add this to the integral of the product of the
second entry in column $u$ and second entry in column $dv$.  This
gives:
$$-x^2\cos(x)+\int 2x\cos(x)\d x,$$
or exactly the result of the first application of integration by
parts.  Since this integral is not yet easy, we return to the table.
Now we multiply twice on the diagonal, $(x^2)(-\cos(x))$ and
$(-2x)(-\sin(x))$ and then once straight across, $(2)(-\sin(x))$, and
combine these as
\[
-x^2\cos(x)+2x\sin(x)-\int 2\sin(x)\d x,
\]
giving the same result as the second application of integration by
parts. While this integral is easy, we may return yet once more to the
table. Now multiply three times on the diagonal to get
$(x^2)(-\cos(x))$, $(-2x)(-\sin(x))$, and $(2)(\cos(x))$, and once
straight across, $(0)(\cos(x))$. We combine these as before to get
\begin{align*}
  -x^2\cos(x)&+2x\sin(x) +2\cos(x)+\int 0\d x\\
  &=-x^2\cos(x)+2x\sin(x) +2\cos(x)+C.
\end{align*}
Typically we would fill in the table one line at a time, until the
``straight across'' multiplication gives an easy integral. If we can
see that the $u$ column will eventually become zero, we can instead
fill in the whole table; computing the products as indicated will then
give the entire integral, including the ``$+C$'', as above.


\begin{example}
Determine the integral $\int e^{x}\cos(x) \d x$
\begin{explanation}

Choose $u=e^{x}$ and $\d v=\cos(x) \d x$. 
Then we have 
\[
\d u =e^{x} \text{ and }  v=\sin(x) 
\]
We obtain the integral
\[
\int e^{x} \cos(x) \d x= e^{x} \sin(x) - \int e^{x} \sin(x) \d x
\]

The integral on the right looks very similar to our original integral. But we persist and try integration by parts on the rightmost integral $\int e^{x} \sin(x) \d x$. 

Choose $u=e^{x}$ and $\d v= \sin(x)$. 
This gives us 

\[
\d u=e^{x} \text{ and } v=-\cos(x)
\]

and so 

\[
\int e^{x}\sin(x) \d x= -e^{x}\cos(x) + \int e^{x} \cos(x) \d x
\]

Plugging this into the formula we derived previously, we have

\[ 
\int e^{x} \cos(x) \d x=e^{x} \sin(x)+e^{x} \cos(x) - \int e^{x} \cos(x) \d x
\]

It may appear that we have not made any progress. We have applied integration by parts twice and all we have managed to do is obtain our original integral again! For the moment let us denote our original integral by $I$, so $I=\int e^{x} \cos(x) \d x$. The quantity $I$ is what we want to find. The above formula we derived can be written as 

\[
 I = e^{x} \sin(x) +e^{x} \cos(x) -I
\] 

Now this equation just looks like an algebraic equation where we can solve for the unknown quantity $I$. 
Solving for $I$ we get 

\[
 I=\int e^{x}\cos(x) \d x= \frac{1}{2} ( e^{x} \sin(x) +e^{x} \cos(x) ) + C
\]

Note we need to include an arbitrary constant of integration since we are finding an antiderivative. The above "trick" is a useful one to keep in mind. If you do integration by parts multiple times and manage to reproduce the orignal integral, then you can solve for the integral in the same manner as we did in this example. 
\end{explanation}
\end{example}



Sometimes we can use integration by parts to give a \dfn{reduction formula}.
This is a formula that will explain how to ``reduce''
the integral to one we may know how to compute.

\begin{example}
  Show that:
  \[
  \int x^n e^x \d x = x^n e^x -n \int x^{n-1} e^x\d x
  \]
  \begin{explanation}
    Here there is almost nothing to do. Set $u= x^n$ and $\d v =
    e^x \d x$. Hence $\d u = n x^{n-1}$ and $v = e^x$. Using the
    integration by parts formula,
    \[
    \int u\d v = uv-\int v\d u,
    \]
    we see immediately that
    \[
    \int x^n e^x \d x = x^n e^x -n \int x^{n-1} e^x \d x.
    \]
  \end{explanation}
\end{example}

This reduction formula shows how to "reduce" the power of $x$ so the resulting integral is slightly easier. We may use repeated applications of this rule to keep reducing the power of $x$ until we arrive at an integral we know how to compute directly. 

\begin{example}
  Use the reduction formula
  \[
  \int x^n e^x \d x = x^n e^x -n \int x^{n-1} e^x\d x
  \]
  to compute the integral
  \[
  \int_0^1 x^3 e^x \d x.
  \]
  \begin{explanation}
    Write with me, from the reduction formula we see:
    \[
    \int_0^1 x^3 e^x \d x = \eval{x^3e^x}_0^1 - \answer[given]{3}\int_0^1 \answer[given]{x^{2} e^x}\d x
    \]
    Applying the formula again to the right most integral we find:
    \[
    \int_0^1 x^{2} e^x\d x = \eval{x^2e^x}_0^1 - \answer[given]{2}\int_0^1 \answer[given]{x e^x}\d x
    \]
    Applying the reduction formula once more to the rightmost integral we find:
    \[
    \int_0^1 x e^x\d x = \eval{xe^x}_0^1 - \int_0^1 \answer[given]{e^x}\d x
    \]
    Hence our final answer is:
    \[
    \int_0^1 x^3 e^x \d x =
    \]
    \begin{align*}
      \eval{x^3e^x}_0^1 &- 3\left(\eval{x^2e^x}_0^1 +  2\left(\eval{xe^x}_0^1 -\eval{e^x}_0^1\right)\right)\\
      &= e - 3e + 3\cdot 2 e -3\cdot 2(\answer[given]{e-1})\\
      &= e-3e+6e-6e+6\\
      &=\answer[given]{6-2e}.
    \end{align*}
  \end{explanation}
\end{example}

%\begin{example}
%We use integration by parts to obtain a reduction formula for:
%\[
%\int (\ln(x))^{n} \d x
%\]
%\begin{explanation}
%We let $u=( \ln(x) )^{n} $ and $\d v= \d x$.
%We obtain
%\[ \d u=n ( \ln(x) )^{n-1}\frac{1}{x} \text{  and  } v=x
%\]
%The integration by parts formula gives us:
%\[
%\int ( \ln(x) )^{n} \d x=\answer[given]{x (ln(x))^{n}} - n \int \answer[given]{(ln(x))^{n-1}} \d x
%\]
%\end{explanation}
%\end{example}

When we covered the substitution method for antiderivatives, we saw that there was no fixed procedure for choosing $u$. There were only certain rules of thumb that might guide you to better or worse choices of which part of the integrand to substitute. The same idea applies in integration by parts. There is no procedure that tells you the best choice for $u$ and $\d v$. However here is a useful heuristic ("rule of thumb") that can guide your choice. 

The heuristic is referred by the mnemonic \textit{ILATE}.  The individual letters stand for different types of functions: 
\begin{align}
&I \text{  stands for inverse trig} \\ 
&L \text{  for logarithmic} \\
&A \text{  for algebraic} \\
&T \text{  for trigonometic} \\
&E \text{  for exponetial}
\end{align}
The idea is that when choosing $u$ and $\d v$, one looks at the types of functions that show up in the integrand. Function types that occur earlier in \textit{ILATE} are better choices for $u$ while those that appear late are better choices for $\d v$. This is because functions near the top of  \textit{ILATE} generally become simpler when they are differentiated. 

For example. in $\int x \ln(x) \d x$, the integrand is made up of a product of a algebraic function $x$ and a logarithmic function $\ln(x)$.  \text{ILATE}  would suggest choosing $u=\ln(x)$ since logarithmic comes above algebraic in \textit{ILATE}. Thus $\d v=x \d x$ since that is the remaining portion. However one should keep in mind that \textit{ILATE} is simply a rule of thumb that does not always apply and can actually make the problem more difficult to solve in some instances. 


\end{document}
