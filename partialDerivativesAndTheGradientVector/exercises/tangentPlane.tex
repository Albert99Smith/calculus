\documentclass{ximera}

\input{../../preamble.tex}
\input{../../sage-preamble.tex}

\author{Jim Fowler}

\outcome{Find a tangent plane to the graph of a function.}

\begin{document}
\makerandom
\begin{sagesilent}
x = var('x')
y = var('y')
f = randint(1,4)*x*x + randint(1,4)*y*y + randint(0,1)*randint(-4,4)*x*y

px = randint(-3,3)
py = randint(-3,3)

plane = f(x=px,y=py) + derivative(f,x)(x=px,y=py) * (x-px) +   derivative(f,y)(x=px,y=py) * (y-py)

cx = plane.coefficient(x)
cy = plane.coefficient(y)
constant = plane - cx*x - cy*y
  
\end{sagesilent}

\begin{exercise}

  Let $F : \R^2 \to \R$ be the function defined by the rule
  \[
    F(x,y) = \sage{f}.
  \]
  Consider the graph $z = F(x,y)$, and find a tangent plane to the
  graph of $F$ at the point $(a,b) = (\sage{px},\sage{py})$.

  \begin{prompt}
    \[
      z = \answer{\sage{cx}} x + \answer{\sage{cy}} y + \answer{\sage{constant}}
    \]
  \end{prompt}

  \begin{hint}
    We may begin by thinking about $F$ around the point $(a,b)$.  First, note that $F(a,b) = \sage{f(x=px,y=py)}$.
  \end{hint}

  \begin{hint}
    Note that $F^{(1,0)}(x,y) = \sage{derivative(f,x)}$.
  \end{hint}

  \begin{hint}
    Consequently $F^{(1,0)}(a,b) = \sage{derivative(f,x)(x=px,y=py)}$.
  \end{hint}  

  \begin{hint}
    Next, $F^{(0,1)}(x,y) = \sage{derivative(f,y)}$.
  \end{hint}

  \begin{hint}
    Consequently $F^{(0,1)}(a,b) = \sage{derivative(f,y)(x=px,y=py)}$.
  \end{hint}

  \begin{hint}
    These derivatives record how changes to the input affect the output.
  \end{hint}

  \begin{hint}
    As we move from $(a,b)$ to a nearby point $(x,y)$, how do we expect $F(a,b)$ to change?
  \end{hint}

  \begin{hint}
    We expect $F(a,b)$ to change by $(x-a)$ times how much the $x$-input affects the output and to change by $(y-b)$ times how much the $y$-input affects the output.
  \end{hint}

  \begin{hint}
    In symbols, this means the change in $F$ is estimated by $(x-a) \cdot F^{(1,0)}(a,b) + (y-b) \cdot F^{(0,1)}(a,b)$.
  \end{hint}

  \begin{hint}
    Substituting in some numbers, this is
    $(x-\sage{px}) \cdot F^{(1,0)}(a,b) + (y-\sage{py}) \cdot F^{(0,1)}(a,b)$, which is
    $\left(x-\sage{px}\right) \cdot \left( \sage{derivative(f,x)(x=px,y=py)} \right) + \left(y-\sage{py}\right) \cdot \left( \sage{derivative(f,y)(x=px,y=py)} \right)$.
  \end{hint}        

  \begin{hint}
    This is the change in $F$ which, if we're thinking in terms of tangent planes, we may write as $z - F(a,b)$.
  \end{hint}

  \begin{hint}
    This means $z - F(a,b) = \left(x-\sage{px}\right) \cdot \left( \sage{derivative(f,x)(x=px,y=py)} \right) + \left(y-\sage{py}\right) \cdot \left( \sage{derivative(f,y)(x=px,y=py)} \right)$.
  \end{hint}

  \begin{hint}
    Since $F(a,b) = \sage{f(x=px,y=py)}$, we can write this as
    \[
      z =  \sage{f(x=px,y=py)} + \left(x-\sage{px}\right) \cdot \left( \sage{derivative(f,x)(x=px,y=py)} \right) + \left(y-\sage{py}\right) \cdot \left( \sage{derivative(f,y)(x=px,y=py)} \right).
    \]
  \end{hint}

  \begin{hint}
    This rearranges to
    \[
      z = \sage{plane}.
    \]
  \end{hint}
  
\end{exercise}
\end{document}
