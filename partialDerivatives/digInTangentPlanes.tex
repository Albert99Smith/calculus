\documentclass{ximera}

\input{../preamble.tex}

\author{Bart Snapp \and Elizabeth Miller \and Jenny Sheldon}

\outcome{Compute tangent planes.}
\outcome{}

\title[Dig-In:]{Tangent planes}

\begin{document}
\begin{abstract}
  We find tangent planes.
\end{abstract}
\maketitle



\subsection{Finding tangent planes}

We say that a function $F: \R^2 \to \R$ is differentiable at some point $a$ if we can 
zoom in on the graph of the function at $a$ and observe that the graph looks more 
and more like a plane near that point.  We have called this plane the tangent plane 
to $F$ at $a$. Let's turn our attention to finding an equation for this plane.

As we are hoping is becoming a habit, let's start by looking again at the case of 
functions of one variable, and use what we know from our previous calculus courses 
to answer our questions in higher dimensions.  As usual with this strategy, we 
proceed with care.

Given a function $f : \R \to \R$ and a point of interest $a$ in the domain of $f$, we 
have previously found an equation for the tangent line to $f$ at $a$, which we also 
called the linear approximation to $f$ at $a$.
\[
L(x) = f(a) + f'(a) \cdot (x-a)
\]

There are three things we should notice about this linear approximation.  First, we 
think about its geometry.  We know that $f'(a)$ is the rate of change of $f$ at $a$, 
and we can think of $(x-a)$ as a distance we have moved from the point $a$.  
Multiplying the two together then gives us an approximate change in the value of the 
function, so to find the new approximate function value, we need to add on our 
original height, or $f(a)$.

Second, we remember that this linear approximation $L(x)$ is also the first-order 
Taylor approximation to $f$.  In other words, $L(x)$ is a function which has the same 
value as $f$ at the point $a$, and also has the same first derivative as $f$ at $a$.

Third, we recall that as we zoom in on the function $f$ at $a$, its graph looks more 
and more like the tangent line $L(x)$.

Now consider the case of $F : \R^2 \to \R$.  We will reconsider the three points we 
made about $L(x)$, but in the reverse order and for our function $F$.  First (or third), 
we have convinced ourselves that as we zoom in on $F$ at some point $(a,b)$, the 
graph looks more and more like a plane.  We will call this plane the linear 
approximation to $F$ at $(a,b)$.  We have seen that the general formula for the 
equation of a plane is
\[
0 = a(x-x_0) + b(y-y_0) + c(z-z_0).
\]
Our one variable linear approximation $L(x)$ was a function just of $x$, so we want 
our two variable linear approximation to be a function of $x$ and $y$.  Solving our 
plane equation for $z$, we find
\[
z = \frac{a}{c}(x-x_0) + \frac{b}{c}(y-y_0) - c\cdot z_0.
\]
If we rename the coefficients and rearrange, we have
\[
z = L(x,y) = T_{\vec{a}}(\vec{x}) = c_0 + c_1(x-x_0) + c_2(y-y_0), 
\]
where $c_0, c_1, x_0$, and $y_0$ are real numbers, $\vec{x} = \vector{x,y}$, and $
\vec{a} = \vector{a,b}$.  In our case, we would like this plane to pass through the point $(a, b, F(a,b))$, so we know that $x_0 = a$ and $y_0 = b$.

Second, we would certainly like our tangent plane $L(x,y)$ to pass through the point $F(a,b)$.  We would also like the partial derivatives of $F$ at $(a,b)$ to match the partial derivatives of $L(x,y) = T_{\vec{a}}(\vec{x})$ at $(a,b)$.  In other words, we have the following conditions.
\begin{align*}
F(\vec{a}) &=T_{\vec{a}}(\vec{a}) \\
 F^{(1,0)}(\vec{a})&=T_{\vec{a}}^{(1,0)}(\vec{a})\\
F^{(0,1)}(\vec{a})&= T_{\vec{a}}^{(0,1)}(\vec{a})
\end{align*}

\begin{question}
What are the first partial derivatives of the tangent plane $T_{\vec{a}}(\vec{x})$, as defined above?

\begin{prompt}
With respect to $x$, we have $T_{\vec{a}}^{(1,0)}(\vec{a}) = \answer[given]{c_1}$.
\end{prompt}

\begin{prompt}
With respect to $y$, we have $T_{\vec{a}}^{(0,1)}(\vec{a}) = \answer[given]{c_2}$.
\end{prompt}
\end{question}

\begin{question}
What is the value of $T_{\vec{a}}(\vec{x})$ when evaluated at $\vec{x} = \vec{a} = \vector{a,b}$?

\begin{prompt}
Plugging in $\vec{x} = \vec{a}$, we find that $T_{\vec{a}}(\vec{a}) = \answer[given]{c_0}$.
\end{prompt}
\end{question}

We are looking for the values of $c_0, c_1$, and $c_2$, and we know the values of $F(a,b), F^{(1,0)}(a,b)$, and $F^{(0,1)}(a,b)$.  Comparing what we want to what we know, we see that we should have the following.
\begin{align*}
c_0 &= F(\vec{a})=T_{\vec{a}}(\vec{a}) \\
c_1 & = F^{(1,0)}(\vec{a})= T_{\vec{a}}^{(1,0)}(\vec{a})\\
c_2 &= F^{(0,1)}(\vec{a})= T_{\vec{a}}^{(0,1)}(\vec{a})
\end{align*}
Our equation for the tangent plane then becomes
\[
z = L(x,y) = T_{\vec{a}}(\vec{x})=F(\vec{a})+ F^{(1,0)}(\vec{a}) (x-a)+ F^{(0,1)}(\vec{a}) (y-b)
\]

This should look quite a lot like what we might want from a first-order Taylor approximation to our function $F$.  That is, the tangent plane at $\vec{a}$ touches the surface at $\vec{a}$ and the partial derivatives all agree at $\vec{a}$.  Saying the tangent plane has the same partial derivatives as the function is another way of saying that tangent plane has to contain the tangent lines we can find using the partial derivatives.

Finally, let's look at some of the geometry of the equation we just found.  We know that $F^{(1,0)}(a,b)$ is the rate of change of $F$ at $(a,b)$ in the direction of $x$, and again we can think of $(x-a)$ as a distance we have moved from the point $a$, but just in the $x$-direction.  Similarly, we know that $F^{(0,1)}(a,b)$ is the rate of change of $F$ at $(a,b)$ in the direction of $y$, and we can think about $(y-b)$ as a distance we have moved from $b$, but just in the $y$-direction.  Adding these two together, we see that we have moved away from the point $(a,b)$, and we are combining these rates of change to get an approximate change in the value of $F$.  Adding this to our original function value $F(a,b)$ gives us our new approximate function value.  In other words, $L(x,y)$ approximates $F(x,y)$ near $(a,b)$.

\begin{question}
What is the normal vector to the plane $L(x,y)$?
\begin{explanation}
To find the normal vector, we would like to rewrite the equation of our plane in the form $\vec{n} \dotp \vec{x} = 0$, or $a(x-x_0) + b(y-y_0) + c(z-z_0) = \answer[given]{0}$.  Then, we can read the coefficients of $\vec{n}$ from the equation.  We begin with our equation of $L(x,y)$, but replace $L(x,y)$ with $z$.
\begin{align*}
z &= F(\vec{a})+ F^{(1,0)}(\vec{a}) \answer[given]{(x-a)}+ F^{(0,1)}(\vec{a}) \answer[given]{(y-b)} \\
0 &= F^{(1,0)}(\vec{a}) \answer[given]{(x-a)}+ F^{(0,1)}(\vec{a}) \answer[given]{(y-b)} - z + F(\vec{a}) \\
0 &= F^{(1,0)}(\vec{a}) \answer[given]{(x-a)}+ F^{(0,1)}(\vec{a}) \answer[given]{(y-b)} - (z - F(\vec{a}))
\end{align*}
We can now see that 
\[
\vec{n} = \vector{F^{(1,0)}(\vec{a}), F^{(0,1)}(\vec{a}), \answer[given]{-1}}.
\]
\end{explanation}
\end{question}
It's reasonable to now ask: what is the geometric significance of this normal vector?  To answer that question, however, we need a few more calculus concepts.  Look out for this in coming sections.

Because it is beneficial to recognize the dot product when it arises, notice that we can rewrite the equation of the tangent plane to look more like the equation from single variable calculus by using the dot product.
\[
T_{\vec{a}}(\vec{x})=F(\vec{a})+ \vector{F^{(1,0)}(\vec{a}), F^{(0,1)}(\vec{a})} \dotp (\vec{x}-\vec{a})
\]

Let's work through a few examples.
\begin{question}
  Find an equation for the tangent plane to $F(x,y) = 3\cos(x)\sin(y)$ at $(x,y) =
  (\pi/3,\pi/6)$.
  \begin{prompt}
    \[
    z = \answer{(-3\sqrt{3}/4)\cdot (x-\pi/3) + (3\sqrt{3}/4)\cdot (y-\pi/6) + 3/4}
    \]
  \end{prompt}
\end{question}

Our next example brings together several important concepts.
\begin{question}
Let $F(x,y) = x^2 + 3xy + 4$.  Answer the following questions about this function.
\begin{question}
Find an equation for the tangent plane to $F$ at $(x,y) = (1,2)$.
     \begin{prompt}
     \[
          z = \answer{11 + 8(x-1) + 3(y-2)}
     \]
     \end{prompt}
\end{question}

\begin{question}
Show that the line $y = 3x - 1$ passes through the point $(1,2)$.
     \begin{explanation}
          We are working here in \wordChoice{\choice[correct]{the $xy$-plane} \choice{$xyz$-space}}.  We would like to see that the point $(1,2)$ lies on the line given.  To do this, we plug in $x = \answer[given]{1}$ to the equation $y = 3x - 1$.  We see that
          \[
          y = 3(\answer[given]{1}) - 1 = \answer[given]{3} - 1 = \answer[given]{2}.
          \]
          Since we got $y = 2$ when $x = 1$, the point $(1, 2)$ \wordChoice{\choice[correct]{is} \choice{is not}} on the line $y = 3x-1$.
     \end{explanation}
\end{question}

\begin{question}
Find a parametric description for the curve lying above $y = 3x-1$ on the surface $z L(x,y) = x^2 + 3xy + 4$.
     \begin{explanation}
          First, we would like a parametric description $\vec{p}(t)$ of the curve $y = 3x-1$ on the $xy$-plane.  Since this curve is already expressed in terms of $x$, the simplest choice is to take $x = \answer[given]{t}$.  We find
          \[
          \vec{p}(t) = \vector{\answer[given]{t}, \answer[given]{3t-1}}.
          \]
          The curve lying on the surface is the collection of all of the images of the points on the line $y = 3x-1$, so we would like to evaluate $F$ on all of these points.  Since we already have a parametric description $\vec{p}(t) = \vector{x(t), y(t)}$, we plug these coordinates in for $x$ and $y$ to find our $z$-coordinate.  We find
          \[
          \vec{r}(t) = F\left( \vec{p}(t) \right ) = \vector{\answer[given]{t}, \answer[given]{3t-1}, \answer[given]{10t^2-3t+4}}
          \]
     \end{explanation}
     
     \begin{question}
     Find an equation for the line tangent to the curve $\vec{r}(t)$ at the point $(1, 2, F(1,2))$.
     \begin{explanation}
          Since our tangent line is in $xyz$-space, we will need to find a parametric equation for this line.  Recall that the most straightforward way to write such an equation is 
          \[
          \vecl(t) = \vec{p} + t\vec{v},
          \]
          where $\vec{p}$ is a point on the line and $\vec{v}$ is a direction vector for the line.  The direction of $\vecl(t)$ is tangent to the curve.  We first find the tangent vector for any value of $t$.
          \[
          \vec{r}'(t) = \vector{\answer[given]{1}, \answer[given]{3}, \answer[given]{20t-3}}
          \]
          To find the tangent vector at $(1,2, F(1,2))$, we plug in $t = \answer[given]{1}$ and find $\vec{r}'(1) = \vector{1, 3, 17}$.  We know that the line goes through the point $\vector{1, 2, \answer[given]{11}}$, and so now we can write the equation of our tangent line.
          \begin{align*}
          \vecl(t) &= \vector{1, 2, \answer[given]{11}} + t \vector{\answer[given]{1}, \answer[given]{3}, \answer[given]{17}} \\
          &= \vector{\answer[given]{1+t}, \answer[given]{2+3t}, \answer[given]{11+17t}}
          \end{align*}
     \end{explanation}     
          \begin{question}
          Does the tangent line $\vecl(t)$ lie in the tangent plane to $F$ at $(1,2)$?
          \begin{explanation}
              We could solve this problem by simply plugging in the coordinate functions of $\vecl(t)$ to the equation $z = L(x,y)$ to see if the two sides of the equals sign agree.  Instead, let's use a little geometry!
              
              We know that both the tangent plane $L(x,y)$ and the line $\vecl(t)$ pass through the point $(1, 2, 11)$.  Since $\vecl(t)$ is a line, its tangent vector $\vec{v}$ tells us everything we need to know about its direction.  Since $L(x,y)$ is a plane, its normal vector $\vec{n}$ tells us everything we need to know about its direction.   Then, if $\vec{v} \dotp \vec{n} = \answer[given]{0}$, we know that the vector $\vec{v}$ must lie in the plane --- and thus the entire line $\vecl(t)$ must line in the plane as well!  First, find $\vec{v}$.
              \[
              \vec{v} = \vector{\answer{1}, \answer{3}, \answer{17}}
              \]
              Next, find $\vec{n}$.
              \[
              \vec{n} = \vector{\answer{8}, \answer{3}, \answer{-1}}
              \]
              Finally, compute their dot product.
              \[
              \vec{v} \dotp \vec{n} = \answer{0}
              \]                  
         \end{explanation}
          \end{question}
     \end{question}
\end{question}






\end{question}


We can also find tangent planes of surfaces that are defined
parameterically.
\begin{example}
Consider the parameterization of the unit sphere,
centered at the origin where $0\le \theta< 2\pi$ and $0\le\phi\le \pi$:
\begin{align*}
  x(\theta,\phi) &= \cos(\theta)\sin(\phi)\\
  y(\theta,\phi) &= \sin(\theta)\sin(\phi)\\
  z(\theta,\phi) &= \cos(\phi)
\end{align*}
Find a plane tangent to the sphere when $\theta = \pi/4$ and $\phi =
\pi/3$.
\begin{explanation}
  Here we'll use the parametric formula for a plane:
  \[
  \vec{L}(s,t) = \vec{p}+ s \vec{v} + t\cdot \vec{w}
  \]
  The the point $\vec{p}$ (denoted by a vector) is:
  \[
  \vec{p} = \vector{\answer[given]{\sqrt{3/8}},\answer[given]{\sqrt{3/8}},\answer[given]{1/2}}
  \]
  The vector $\vec{v}$ is given by
  \begin{align*}
    \vec{v} &=\eval{\pp{\theta}\vector{x(\theta,\phi),y(\theta,\phi),z(\theta,\phi)}}_{\substack{\theta = \pi/4\\ \phi = \pi/3}}\\
      &= \eval{\vector{\answer[given]{-\sin(\theta)\sin(\phi)},\answer[given]{\cos(\theta)\sin(\phi)},\answer[given]{0}}}_{\substack{\theta = \pi/4\\ \phi = \pi/3}}\\
      &= \vector{-\sqrt{3/8},\sqrt{3/8},0}
  \end{align*}
  And vector $\vec{w}$ is given by
  \begin{align*}
    \vec{w} &=\eval{\pp{\phi}\vector{x(\theta,\phi),y(\theta,\phi),z(\theta,\phi)}}_{\substack{\theta = \pi/4\\ \phi = \pi/3}}\\
      &= \eval{\vector{\answer[given]{\cos(\theta)\cos(\phi)},\answer[given]{\sin(\theta)\cos(\phi)},\answer[given]{-\sin(\phi)}}}_{\substack{\theta = \pi/4\\ \phi = \pi/3}}\\
      &= \vector{1/\sqrt{8},1/\sqrt{8},-\sqrt{3}/2}
  \end{align*}
  Hence our desired plane is given by:
  \[
  \vec{L}(s,t) = \begin{bmatrix}
    \answer[given]{\sqrt{3/8}-s\sqrt{3/8}+ t/\sqrt{8}}\\
    \answer[given]{\sqrt{3/8} +s\sqrt{3/8} + t/\sqrt{8}}\\
    \answer[given]{1/2 -t\sqrt{3}/2}
  \end{bmatrix}
  \]
\end{explanation}
\end{example}



\end{document}
